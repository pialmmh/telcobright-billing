drop procedure CauseOutIntCase1;		
DELIMITER //		
create procedure CauseOutIntCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(releasecauseingress) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase2;		
DELIMITER //		
create procedure CauseOutIntCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase3;		
DELIMITER //		
create procedure CauseOutIntCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase4;		
DELIMITER //		
create procedure CauseOutIntCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase5;		
DELIMITER //		
create procedure CauseOutIntCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase6;		
DELIMITER //		
create procedure CauseOutIntCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase7;		
DELIMITER //		
create procedure CauseOutIntCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase8;		
DELIMITER //		
create procedure CauseOutIntCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase9;		
DELIMITER //		
create procedure CauseOutIntCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase10;		
DELIMITER //		
create procedure CauseOutIntCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase11;		
DELIMITER //		
create procedure CauseOutIntCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase12;		
DELIMITER //		
create procedure CauseOutIntCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase13;		
DELIMITER //		
create procedure CauseOutIntCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase14;		
DELIMITER //		
create procedure CauseOutIntCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase15;		
DELIMITER //		
create procedure CauseOutIntCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase16;		
DELIMITER //		
create procedure CauseOutIntCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase17;		
DELIMITER //		
create procedure CauseOutIntCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase18;		
DELIMITER //		
create procedure CauseOutIntCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase19;		
DELIMITER //		
create procedure CauseOutIntCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase20;		
DELIMITER //		
create procedure CauseOutIntCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase21;		
DELIMITER //		
create procedure CauseOutIntCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase22;		
DELIMITER //		
create procedure CauseOutIntCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase23;		
DELIMITER //		
create procedure CauseOutIntCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase24;		
DELIMITER //		
create procedure CauseOutIntCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase25;		
DELIMITER //		
create procedure CauseOutIntCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase26;		
DELIMITER //		
create procedure CauseOutIntCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase27;		
DELIMITER //		
create procedure CauseOutIntCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase28;		
DELIMITER //		
create procedure CauseOutIntCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase29;		
DELIMITER //		
create procedure CauseOutIntCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase30;		
DELIMITER //		
create procedure CauseOutIntCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase31;		
DELIMITER //		
create procedure CauseOutIntCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase32;		
DELIMITER //		
create procedure CauseOutIntCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase33;		
DELIMITER //		
create procedure CauseOutIntCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase34;		
DELIMITER //		
create procedure CauseOutIntCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCase35;		
DELIMITER //		
create procedure CauseOutIntCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCase36;		
DELIMITER //		
create procedure CauseOutIntCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase19;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase20;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase21;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase22;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntOneCountryCase23;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase24;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase25;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntOneCountryCase26;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase27;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntOneCountryCase28;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase29;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase30;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase31;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntOneCountryCase32;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase33;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase34;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntOneCountryCase35;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntOneCountryCase36;		
DELIMITER //		
create procedure CauseOutIntOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase19;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase20;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase21;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase22;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntOneCountryCase23;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase24;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase25;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntOneCountryCase26;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase27;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntOneCountryCase28;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase29;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase30;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase31;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntOneCountryCase32;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase33;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase34;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntOneCountryCase35;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntOneCountryCase36;		
DELIMITER //		
create procedure CauseSummaryOutIntOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
where cx.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
		
drop procedure CauseSummaryOutIntCase1;		
DELIMITER //		
create procedure CauseSummaryOutIntCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase2;		
DELIMITER //		
create procedure CauseSummaryOutIntCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase3;		
DELIMITER //		
create procedure CauseSummaryOutIntCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase4;		
DELIMITER //		
create procedure CauseSummaryOutIntCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase5;		
DELIMITER //		
create procedure CauseSummaryOutIntCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase6;		
DELIMITER //		
create procedure CauseSummaryOutIntCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase7;		
DELIMITER //		
create procedure CauseSummaryOutIntCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase8;		
DELIMITER //		
create procedure CauseSummaryOutIntCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase9;		
DELIMITER //		
create procedure CauseSummaryOutIntCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase10;		
DELIMITER //		
create procedure CauseSummaryOutIntCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase11;		
DELIMITER //		
create procedure CauseSummaryOutIntCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase12;		
DELIMITER //		
create procedure CauseSummaryOutIntCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase13;		
DELIMITER //		
create procedure CauseSummaryOutIntCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase14;		
DELIMITER //		
create procedure CauseSummaryOutIntCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase15;		
DELIMITER //		
create procedure CauseSummaryOutIntCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase16;		
DELIMITER //		
create procedure CauseSummaryOutIntCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase17;		
DELIMITER //		
create procedure CauseSummaryOutIntCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase18;		
DELIMITER //		
create procedure CauseSummaryOutIntCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
where x.CountryCode=p_CountryCode		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase19;		
DELIMITER //		
create procedure CauseSummaryOutIntCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase20;		
DELIMITER //		
create procedure CauseSummaryOutIntCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase21;		
DELIMITER //		
create procedure CauseSummaryOutIntCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase22;		
DELIMITER //		
create procedure CauseSummaryOutIntCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase23;		
DELIMITER //		
create procedure CauseSummaryOutIntCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase24;		
DELIMITER //		
create procedure CauseSummaryOutIntCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase25;		
DELIMITER //		
create procedure CauseSummaryOutIntCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase26;		
DELIMITER //		
create procedure CauseSummaryOutIntCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase27;		
DELIMITER //		
create procedure CauseSummaryOutIntCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase28;		
DELIMITER //		
create procedure CauseSummaryOutIntCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase29;		
DELIMITER //		
create procedure CauseSummaryOutIntCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase30;		
DELIMITER //		
create procedure CauseSummaryOutIntCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase31;		
DELIMITER //		
create procedure CauseSummaryOutIntCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase32;		
DELIMITER //		
create procedure CauseSummaryOutIntCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase33;		
DELIMITER //		
create procedure CauseSummaryOutIntCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase34;		
DELIMITER //		
create procedure CauseSummaryOutIntCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCase35;		
DELIMITER //		
create procedure CauseSummaryOutIntCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCase36;		
DELIMITER //		
create procedure CauseSummaryOutIntCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase1;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode	,supplierid	
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase2;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase3;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase4;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase5;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase6;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase7;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase8;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase9;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase10;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase11;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase12;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase13;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase14;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase15;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase16;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase17;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase18;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase19;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase20;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase21;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase22;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase23;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase24;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase25;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase26;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase27;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase28;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase29;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase30;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase31;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase32;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase33;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase34;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllCase35;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllCase36;		
DELIMITER //		
create procedure CauseOutIntCarrierAllCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase19;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase20;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase21;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase22;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllOneCountryCase23;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase24;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase25;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllOneCountryCase26;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase27;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllOneCountryCase28;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase29;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase30;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase31;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllOneCountryCase32;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase33;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase34;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierAllOneCountryCase35;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierAllOneCountryCase36;		
DELIMITER //		
create procedure CauseOutIntCarrierAllOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
		
		
drop procedure CauseOutIntCarrierOneCase1;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase1(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode	,supplierid	
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase2;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase2(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase3;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase3(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase4;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase4(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase5;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase5(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase6;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase6(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase7;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase7(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase8;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase8(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase9;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase9(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase10;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase10(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,supplierid		
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase11;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase11(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase12;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase12(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase13;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase13(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase14;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase14(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase15;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase15(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase16;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase16(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase17;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase17(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase18;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase18(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`),CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase19;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase19(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase20;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase20(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase21;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase21(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase22;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase22(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase23;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase23(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase24;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase24(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase25;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase25(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase26;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase26(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase27;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase27(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase28;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase28(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase29;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase29(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase30;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase30(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase31;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase31(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase32;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase32(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase33;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase33(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase34;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase34(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneCase35;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase35(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneCase36;		
DELIMITER //		
create procedure CauseOutIntCarrierOneCase36(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase19;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase19(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase20;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase20(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase21;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase21(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase22;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase22(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneOneCountryCase23;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase23(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase24;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase24(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase25;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase25(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneOneCountryCase26;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase26(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase27;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase27(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneOneCountryCase28;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase28(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase29;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase29(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase30;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase30(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase31;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase31(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneOneCountryCase32;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase32(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase33;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase33(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase34;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase34(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutIntCarrierOneOneCountryCase35;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase35(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutIntCarrierOneOneCountryCase36;		
DELIMITER //		
create procedure CauseOutIntCarrierOneOneCountryCase36(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   date(`Date`),MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase1;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode	,supplierid	
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase2;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase3;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase4;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase5;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase6;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase7;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase8;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase9;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase10;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase11;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase12;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase13;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase14;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase15;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase16;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase17;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase18;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase19;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase20;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase21;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase22;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase23;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase24;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase25;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase26;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase27;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase28;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase29;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase30;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase31;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase32;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase33;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase34;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllCase35;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllCase36;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase19;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase20;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase21;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase22;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase23;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase24;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase25;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase26;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase27;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase28;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase29;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase30;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase31;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase32;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase33;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase34;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase35;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierAllOneCountryCase36;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierAllOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase1;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase1(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   CountryCode	,supplierid	
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase2;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase2(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase3;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase3(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase4;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase4(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase5;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase5(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase6;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase6(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase7;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase7(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase8;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase8(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase9;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase9(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase10;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase10(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   CountryCode		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase11;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase11(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase12;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase12(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase13;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase13(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase14;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase14(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase15;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase15(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase16;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase16(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   CountryCode,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase17;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase17(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase18;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase18(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select concat(cn.name,' (',x.CountryCode,')') as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,CountryCode,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   CountryCode,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CountryCode cn		
on x.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where x.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase19;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase19(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase20;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase20(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase21;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase21(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase22;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase22(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,supplierid		
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase23;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase23(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase24;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase24(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase25;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase25(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase26;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase26(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase27;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase27(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase28;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase28(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase29;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase29(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase30;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase30(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase31;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase31(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase32;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase32(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase33;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase33(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase34;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase34(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneCase35;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase35(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneCase36;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneCase36(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase19;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase19(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase20;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase20(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase21;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase21(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase22;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase22(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase23;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase23(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase24;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase24(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase25;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase25(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase26;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase26(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase27;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase27(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase28;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase28(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase29;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase29(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase30;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase30(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase31;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase31(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase32;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase32(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and MatchedPrefixY=p_MatchedPrefixY    		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase33;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase33(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase34;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase34(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase35;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase35(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutIntCarrierOneOneCountryCase36;		
DELIMITER //		
create procedure CauseSummaryOutIntCarrierOneOneCountryCase36(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select concat(cn.name,' (',cx.CountryCode,')') as Country,concat(x.MatchedPrefixY,' (',cx.Description,')') AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid,MatchedPrefixY,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  and MatchedPrefixY=p_MatchedPrefixY  		
  group by chargingstatus,releasecauseingress,   MatchedPrefixY,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
left join CustomerRateICX cx		
on x.MatchedPrefixY=cx.Prefix		
left join CountryCode cn		
on cx.CountryCode=cn.Code		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
where cx.CountryCode=p_CountryCode		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		


drop procedure CauseOutNoDestIntCase1;		
DELIMITER //		
create procedure CauseOutNoDestIntCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 		
having sum(chargingstatus)>0  ) x		
		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase2;		
DELIMITER //		
create procedure CauseOutNoDestIntCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase3;		
DELIMITER //		
create procedure CauseOutNoDestIntCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase4;		
DELIMITER //		
create procedure CauseOutNoDestIntCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase5;		
DELIMITER //		
create procedure CauseOutNoDestIntCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase6;		
DELIMITER //		
create procedure CauseOutNoDestIntCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase7;		
DELIMITER //		
create procedure CauseOutNoDestIntCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase8;		
DELIMITER //		
create procedure CauseOutNoDestIntCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase9;		
DELIMITER //		
create procedure CauseOutNoDestIntCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase10;		
DELIMITER //		
create procedure CauseOutNoDestIntCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 		
having sum(chargingstatus)>0  ) x		
		
		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase11;		
DELIMITER //		
create procedure CauseOutNoDestIntCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase12;		
DELIMITER //		
create procedure CauseOutNoDestIntCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase13;		
DELIMITER //		
create procedure CauseOutNoDestIntCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase14;		
DELIMITER //		
create procedure CauseOutNoDestIntCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase15;		
DELIMITER //		
create procedure CauseOutNoDestIntCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase16;		
DELIMITER //		
create procedure CauseOutNoDestIntCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase17;		
DELIMITER //		
create procedure CauseOutNoDestIntCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase18;		
DELIMITER //		
create procedure CauseOutNoDestIntCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase19;		
DELIMITER //		
create procedure CauseOutNoDestIntCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 		
having sum(chargingstatus)>0  ) x		
		
		
		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase20;		
DELIMITER //		
create procedure CauseOutNoDestIntCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase21;		
DELIMITER //		
create procedure CauseOutNoDestIntCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase22;		
DELIMITER //		
create procedure CauseOutNoDestIntCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase23;		
DELIMITER //		
create procedure CauseOutNoDestIntCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase24;		
DELIMITER //		
create procedure CauseOutNoDestIntCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase25;		
DELIMITER //		
create procedure CauseOutNoDestIntCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase26;		
DELIMITER //		
create procedure CauseOutNoDestIntCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase27;		
DELIMITER //		
create procedure CauseOutNoDestIntCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase28;		
DELIMITER //		
create procedure CauseOutNoDestIntCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		
having sum(chargingstatus)>0  ) x		
		
		
		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase29;		
DELIMITER //		
create procedure CauseOutNoDestIntCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase30;		
DELIMITER //		
create procedure CauseOutNoDestIntCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase31;		
DELIMITER //		
create procedure CauseOutNoDestIntCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase32;		
DELIMITER //		
create procedure CauseOutNoDestIntCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase33;		
DELIMITER //		
create procedure CauseOutNoDestIntCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase34;		
DELIMITER //		
create procedure CauseOutNoDestIntCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCase35;		
DELIMITER //		
create procedure CauseOutNoDestIntCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCase36;		
DELIMITER //		
create procedure CauseOutNoDestIntCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase19;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 		
having sum(chargingstatus)>0  ) x		
		
		
		
		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase20;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase21;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase22;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntOneCountryCase23;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase24;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase25;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntOneCountryCase26;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase27;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntOneCountryCase28;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		
having sum(chargingstatus)>0  ) x		
		
		
		
		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase29;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase30;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase31;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntOneCountryCase32;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase33;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase34;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntOneCountryCase35;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntOneCountryCase36;		
DELIMITER //		
create procedure CauseOutNoDestIntOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase19;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
group by chargingstatus,releasecauseingress  		
having sum(chargingstatus)>0  ) x		
		
		
		
		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase20;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase21;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase22;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase23;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase24;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase25;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase26;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase27;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase28;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
group by chargingstatus,releasecauseingress  		
having sum(chargingstatus)>0  ) x		
		
		
		
		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase29;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase30;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase31;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase32;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase33;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase34;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase35;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntOneCountryCase36;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
		
drop procedure CauseSummaryOutNoDestIntCase1;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
group by chargingstatus,releasecauseingress  		
having sum(chargingstatus)>0  ) x		
		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase2;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase3;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase4;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase5;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase6;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase7;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase8;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase9;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase10;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
group by chargingstatus,releasecauseingress  		
having sum(chargingstatus)>0  ) x		
		
		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase11;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase12;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase13;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase14;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase15;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase16;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase17;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase18;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase19;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
group by chargingstatus,releasecauseingress  		
having sum(chargingstatus)>0  ) x		
		
		
		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase20;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase21;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase22;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase23;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase24;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase25;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase26;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase27;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase28;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
group by chargingstatus,releasecauseingress  		
having sum(chargingstatus)>0  ) x		
		
		
		
		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase29;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase30;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase31;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase32;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase33;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase34;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCase35;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCase36;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', (select null) as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
order by  `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase1;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 	,supplierid	
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase2;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase3;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase4;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase5;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase6;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase7;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase8;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase9;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase10;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase11;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase12;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase13;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase14;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase15;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase16;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase17;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase18;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase19;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase20;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase21;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase22;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase23;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase24;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase25;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase26;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase27;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase28;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase29;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase30;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase31;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase32;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase33;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase34;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllCase35;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllCase36;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase19;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase20;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase21;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase22;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase23;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase24;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase25;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase26;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase27;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase28;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase29;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase30;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase31;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase32;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase33;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase34;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase35;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierAllOneCountryCase36;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierAllOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase1;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase1(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   date(`Date`) 	,supplierid	
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase2;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase2(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase3;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase3(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase4;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase4(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase5;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase5(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase6;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase6(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase7;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase7(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase8;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase8(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase9;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase9(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase10;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase10(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,supplierid		
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase11;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase11(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase12;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase12(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date` ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase13;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase13(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase14;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase14(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase15;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase15(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase16;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase16(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase17;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase17(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase18;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase18(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase19;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase19(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase20;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase20(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase21;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase21(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase22;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase22(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase23;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase23(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase24;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase24(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase25;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase25(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase26;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase26(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase27;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase27(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase28;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase28(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase29;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase29(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase30;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase30(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase31;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase31(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase32;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase32(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase33;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase33(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase34;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase34(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneCase35;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase35(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneCase36;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneCase36(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase19;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase19(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase20;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase20(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase21;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase21(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase22;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase22(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase23;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase23(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase24;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase24(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase25;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase25(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase26;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase26(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase27;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase27(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase28;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase28(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) 		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase29;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase29(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase30;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase30(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase31;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase31(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase32;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase32(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase33;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase33(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase34;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase34(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase35;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase35(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseOutNoDestIntCarrierOneOneCountryCase36;		
DELIMITER //		
create procedure CauseOutNoDestIntCarrierOneOneCountryCase36(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select DATE_FORMAT(`Date`,'%d/%m/%Y') as `Date`,(select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select date(StartTime)as `Date`,AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   date(`Date`) ,customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by date asc, `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase1;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase1(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase2;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase2(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase3;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase3(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase4;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase4(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase5;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase5(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase6;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase6(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase7;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase7(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase8;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase8(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase9;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase9(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase10;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase10(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase11;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase11(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase12;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase12(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase13;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase13(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase14;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase14(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase15;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase15(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase16;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase16(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase17;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase17(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase18;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase18(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase19;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase19(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase20;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase20(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase21;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase21(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase22;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase22(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase23;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase23(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase24;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase24(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase25;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase25(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase26;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase26(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase27;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase27(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase28;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase28(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase29;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase29(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase30;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase30(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase31;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase31(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase32;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase32(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase33;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase33(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase34;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase34(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase35;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase35(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllCase36;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllCase36(IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase19;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase19(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase20;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase20(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase21;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase21(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase22;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase22(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase23;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase23(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase24;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase24(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase25;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase25(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase26;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase26(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase27;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase27(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase28;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase28(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase29;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase29(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase30;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase30(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase31;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase31(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase32;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase32(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
      		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase33;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase33(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase34;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase34(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase35;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase35(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase36;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierAllOneCountryCase36(IN p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase1;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase1(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase2;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase2(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
	and supplierid=p_intlcarrier	
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase3;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase3(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase4;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase4(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase5;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase5(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase6;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase6(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase7;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase7(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase8;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase8(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase9;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase9(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase10;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase10(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase11;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase11(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase12;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase12(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase13;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase13(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase14;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase14(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase15;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase15(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase16;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase16(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase17;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase17(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
        count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_igwid  		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase18;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase18(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),		
IN p_AnsId int,IN p_IgwId int,IN p_CountryCode varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
select (select NULL)  as Country,(SELECT NULL) AS Destination,cr.CarrierName AS ANS,ig.carriername AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,AnsIdOrig,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
  count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig,customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join Carrier ig		
on x.customerid=ig.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase19;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase19(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase20;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase20(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase21;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase21(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase22;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase22(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   customerid,supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase23;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase23(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase24;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase24(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase25;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase25(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase26;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase26(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase27;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase27(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase28;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase28(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase29;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase29(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase30;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase30(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase31;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase31(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase32;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase32(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase33;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase33(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase34;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase34(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase35;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase35(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneCase36;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneCase36(IN p_IntlCarrier int,  p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase19;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase19(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase20;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase20(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase21;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase21(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase22;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase22(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase23;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase23(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase24;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase24(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase25;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase25(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase26;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase26(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase27;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase27(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int)		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId  		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase28;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase28(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   supplierid		
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase29;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase29(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase30;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase30(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,cr.CarrierName AS ANS,(SELECT NULL) AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.AnsIdOrig=cr.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase31;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase31(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase32;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase32(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
      		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase33;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase33(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase34;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase34(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,(SELECT NULL) AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase35;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase35(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		
		
		
drop procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase36;		
DELIMITER //		
create procedure CauseSummaryOutNoDestIntCarrierOneOneCountryCase36(IN p_IntlCarrier int,  p_CountryCode varchar(45),IN p_UsdRateY float,IN p_StartDateTime varchar(45), IN p_EndDateTime varchar(45),IN p_AnsId int,IN p_IgwId int,IN p_MatchedPrefixY varchar(45))		
BEGIN		
		
declare varStartDate varchar(45);		
declare varEndDate varchar(45);		
		
IF LENGTH(p_StartDateTime)=19 THEN		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' ',		
                        substring(p_StartDateTime,12,8));		
ELSE		
set varStartDate=concat(substring(p_StartDateTime,7,4),'-',		
                        substring(p_StartDateTime,4,2),'-',		
                        substring(p_StartDateTime,1,2),' 00:00:00');		
		
END IF;		
		
IF LENGTH(p_EndDateTime)=19 THEN		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' ',		
                        substring(p_EndDateTime,12,8));		
ELSE		
set varEndDate=concat(substring(p_EndDateTime,7,4),'-',		
                        substring(p_EndDateTime,4,2),'-',		
                        substring(p_EndDateTime,1,2),' 23:59:59');		
		
END IF;		
		
		
		
select (select NULL) as Country,(select NULL) AS Destination,crAns.CarrierName AS ANS,cr.CarrierName AS IGW,		
Callsout as 'No of Calls (Outgoing International)',MinutesOut as 'Paid Minutes (Outgoing Internaitonal)',		
Xbdt as 'X (BDT)',YUsd as 'Y (USD)',round(Zbdt,6) as 'Z (BDT)', crintl.CarrierName as 'International Carrier',revenueigwout,suppliercost,profitbdt, profitminute,profitminute as rubbish,asr,acd,pdd,ccr,CallsCount,ConnectedCount
from		
	(select AnsIdOrig,customerid ,case chargingstatus when 1 then 'Success' else 'failed' end as Callsout, ReleaseCauseIngress as MinutesOut,	
    count(*) as Xbdt,(select NULL) as Yusd,		
  (select NULL) as Zbdt		
	, Supplierid , (select NULL) as revenueigwout,(select NULL) as suppliercost,(select NULL) as profitbdt,(select NULL) as profitminute	
, (select NULL) as ASR, (select NULL) as ACD,(select NULL) as PDD , (select NULL) as CCR,  count(*) as CallsCount,(select NULL) as ConnectedCount 		
from cdrloaded		
 c left join usdexchangerateagainstbdt u on c.field1=u.field1 and c.field2=u.field2		
	where starttime>=varStartDate	
	and starttime<=varEndDate	
		
	and calldirection=2	
  and supplierid=p_intlcarrier		
  and AnsIdOrig=p_AnsId		
  and customerid=p_IgwId		
    		
  group by chargingstatus,releasecauseingress,   customerid,AnsIdOrig		,supplierid
having sum(chargingstatus)>0  ) x		
		
		
		
		
left join Carrier cr		
on x.customerid=cr.idcarrier		
left join Carrier crAns		
on x.AnsIdOrig=crAns.idCarrier		
left join carrier crintl		
on x.supplierid=crintl.idcarrier		
		
order by `Paid Minutes (Outgoing Internaitonal)` desc,IGW asc,ANS asc;		
		
END //		
DELIMITER ;		

